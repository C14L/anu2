<html lang="en" ng-app="anu2app">
  <head>
    <meta name="viewport" content="initial-scale=1" />
    <base href="/">
    <title></title>
    <meta name="description" content="">
    <meta name="robots" content="">
    <link rel="canonical" href="">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.css">
    <style>

.md-fab-top-right { top: 28px !important; } /* needs 28px top margin to be aligned with header bar. */
.md-toolbar-tools h1 { font-size: inherit; font-weight: inherit; margin: inherit; }

.category-list-view a { color: inherit; text-decoration: none; }
.category-list-view a:hover { color: #0000FF; text-decoration: underline; }

.item-list-view .post-item a { text-decoration: none; }
.item-list-view .post-item.expired { color: #C0C0C0; }
.item-list-view .post-item.expired a { color: #C0C0C0; }
.item-list-view .post-item a:hover { text-decoration: underline; }

.home-view .category-list-view,
.home-view .category-list-view h2,
.home-view .category-list-view span { color: #909090; }
.home-view .manual-geoloc { padding: 8px 32px 32px 32px; background-color: #e3e3e3; }
.home-view .loading-geoloc { padding: 32px; background-color: #e3e3e3; }
.home-view .loading-geoloc md-progress-circular { }
.home-view .loading-geoloc .text { margin-bottom: 16px; text-align: center; }

.postitem-view {  }
.postitem-view a { text-decoration: none; }
.postitem-view.expired,
.postitem-view.expired a { color: #C0C0C0; }

.add-post-view .todolist { list-style: none; margin: 0; padding: 0; background-color: #E3E3E3; }
.add-post-view .todolist li { display: inline-block; margin: 0; padding: 8px; color: #909090; }
.add-post-view .todolist li.active { color: #000000; }
.add-post-view .formfields { max-width: 500px; }
.add-post-view .formfields md-input-container { clear: right; }

.add-post-view .piclist { display: block; margin: 16px 0; }
.add-post-view .piclist .pic { display: inline-block; width: 150px; height: 150px; background: #909090 url(static/icons/images.svg) center center no-repeat; background-size: cover; border: 4px solid #FFFFFF; box-shadow: 0 0 0 3px rgba(0,0,0,0.2); position: relative; margin: 4px; }
.add-post-view .piclist .pic:before { content: ' '; position: absolute; top: 0; right: 0; bottom: 0; left: 0; background-color: rgba(255,255,255,0.7); }
.add-post-view .piclist .pic input[type="file"] { z-index: 10; display: block; width: inherit; height: inherit; opacity: 0; cursor: pointer; }
.add-post-view .piclist .pic img { position: absolute; top: 0; left: 0; background: #F3F3F3; width: inherit; height: inherit; margin: 0; padding: 0; outline: 0; border: 0; }
.add-post-view .piclist .pic .wait { display: flex; align-items: center; justify-content: center; position: absolute; top: 0; right: 0; bottom: 0; left: 0; background-color: rgba(255,255,255,1); color: #000000; font-size: small; }
.add-post-view .piclist .pic .add-btn,
.add-post-view .piclist .pic .remove-btn { position: absolute; bottom: 8px; right: 8px; }

    </style>
    <script>

var LOG = window.LOG || true;

function setTitle(s){window.document.title=s;}
function setRobots(s){window.document.head.querySelector('meta[name="robots"]')['content']=s;}
function setDescription(s){window.document.head.querySelector('meta[name="description"]')['content']=s;}
function getRandomInt(min,max){/*Random int: min <= x < max */return Math.floor(Math.random()*(max-min))+min;}
function setCanonical(s){window.document.head.querySelector('link[rel="canonical"]')['href']=s;}

    </script>
  </head>
  <body ng-controller="AppController" layout="column" layout-fill>

    <md-toolbar layout="row">
      <div class="md-toolbar-tools">
        <md-button ng-click="toggleSidenav('left')" hide-gt-md class="md-icon-button">
          <md-icon md-svg-src="static/icons/menu.svg" aria-label="Menu"></md-icon>
        </md-button>
        <h1><a href="{{page.home_url}}">{{page.h1}}</a></h1>
      </div>
    </md-toolbar>

    <md-button ng-if="addFabStatus==1" ng-click="addFabInfoDialog($event)" class="md-fab md-fab-top-right" aria-label="{{tr('agregar')}}"><md-icon md-svg-src="static/icons/android-add.svg"></md-icon></md-button>

    <md-button ng-if="addFabStatus!=0 && addFabStatus!=1" ng-href="{{addFabStatus}}/add" class="md-fab md-fab-top-right" aria-label="{{tr('agregar')}}"><md-icon style="margin-top:14px;margin-left:-1px;" md-svg-src="static/icons/android-add.svg"></md-icon></md-button>

    <md-content layout="row" flex>
      <md-sidenav layout="column" class="md-sidenav-left md-whiteframe-z2" md-component-id="left" md-is-locked-open="$mdMedia('gt-md')">
        <div hide-gt-md class="md-toolbar-tools">
          <md-button ng-click="toggleSidenav('left')" hide-gt-md class="md-icon-button">
            <md-icon md-svg-src="static/icons/close.svg" aria-label="Close"></md-icon>
          </md-button>
          <h1>{{site.title}}</h1>
        </div>
        <md-list>
          <md-list-item class="md-2-line" ng-repeat="item in sidebarList">
            <md-checkbox ng-model="item.done"></md-checkbox>
            <div class="md-list-item-text">
              <h3 ng-bind="item.title"></h3>
              <p ng-bind="item.description"></p>
            </div>
          </md-list-item>
        </md-list>
      </md-sidenav>
      <md-content id="content" layout="column" flex class="md-padding" ng-view="main">
          Loading...
      </md-content>
    </md-content>
  </body>

<!--
// Templates //////////////////////////////////////////////////////////////////
-->

  <script type="text/ng-template" id="home.html">
    <div class="home-view">
      
      <div ng-show="isSearchingLocation">
        <div class="loading-geoloc">
          <div class="text" ng-bind="tr('Encontrando tu ciudad...')"></div>
          <div layout="row" layout-sm="column" layout-align="space-around">
            <md-progress-circular md-mode="indeterminate" class="md-hue-3"></md-progress-circular>
          </div>
        </div>
      </div>
      
      <div ng-show="isManualCityFinder">
        <div class="manual-geoloc">
          <h2 ng-bind="tr('Encuentra clasificados en tu ciudad:')"></h2>
          <md-autocomplete 
            md-selected-item-change="locationSelected(selectedItem)"
            md-selected-item="selectedItem" 
            md-search-text="searchText" 
            md-items="item in getMatches(searchText)" 
            md-item-text="item.crc"
            md-delay="300"
            md-min-length="3"
            md-input-minlength="10"
            md-input-maxlength="100"
            md-autofocus="1"
            md-autoselect="1"
            md-select-on-match="1"
            placeholder="{{tr('Escribe unos letras del nombre de tu ciudad...')}}">
            <md-item-template>
              <span md-highlight-text="searchText">{{item.crc}}</span>
            </md-item-template>
            <md-not-found>
              <span>{{tr('No se encontró ninguna ciudad con este nombre.')}}</span>
            </md-not-found>
          </md-autocomplete>
        </div>
      </div>

      <div class="category-list-view">
        <div ng-repeat="(slug, root) in categoryTree track by slug">
          <h2 ng-bind="root.title"></h2>
          <div ng-repeat="child in root.children track by child.slug">
            <span ng-href="{{loc.url}}/{{root.slug}}/{{child.slug}}" ng-bind="child.title"></span>
          </div>
        </div>
      </div>
    
    </div>
  </script>

  <script type="text/ng-template" id="location.html">
    <div class="location-view category-list-view">
      <h1>{{tr('Clasificados para {0}', [geoloc.city_name])}}</h1>
      <p>{{page.description}}</p>
      <div ng-repeat="(slug, root) in categoryTree track by slug">
        <h2><a ng-href="{{geoloc.url}}/{{root.slug}}" title="{{tr('Anuncions clasificados de {0} de {1}', [root.title, geoloc.city_name])}}">{{tr('{0} en {1}', [root.title, geoloc.city_name])}}</a></h2>
        <div ng-repeat="child in root.children track by child.slug">
          <a ng-href="{{geoloc.url}}/{{root.slug}}/{{child.slug}}" title="{{tr('Anuncions clasificados de {0} de {1}', [child.title, geoloc.city_name])}}">{{child.title}}</a>
        </div>
      </div>
    </div>
  </script>

  <script type="text/ng-template" id="category.html">
    <div class="category-view item-list-view">
      <h1 ng-bind="category.title"></h1>
      <p ng-bind="page.description"></p>
      <div ng-if="!posts" layout="row" layout-sm="column" layout-align="space-around">
        <md-progress-circular md-mode="indeterminate" class="md-hue-3"></md-progress-circular>
      </div>
      <div ng-if="posts" class="post-item" ng-class="{'expired': post.expired}" ng-repeat="post in posts.results track by post.id">
        <h3 class="post-title"><a href="#" ng-href="{{post.url}}">{{post.title}}</a></h3>
        <p>
          <span>{{tr('categoria: {0} en {1}, {2}', [post.category, geoloc.city_name, geoloc.country_name])}}</span> - 
          <span>{{tr('publicado:')}} {{post.publish}}</span> - 
          <span>{{tr('valido hasta:')}} {{post.expires}}</span> - 
          <a ng-if="!post.expired" ng-href="{{post.url}}">{{tr('ver clasificado')}}</a>
          <a ng-if="post.expired" ng-href="{{post.url}}">{{tr('clasificado expirado')}}</a>
        </p>
      </div>
      <div class="prevnext">
        <a ng-if="posts.previous" ng-href="{{posts.previous}}" ng-bind="tr('previous')"></a>
        <a ng-if="posts.next" ng-href="{{posts.next}}" ng-bind="tr('next')"></a>
      </div>
    </div>
  </script>

  <script type="text/ng-template" id="postitem.html">
    <div class="postitem-view" ng-class="{'expired': post.expired}">
      <h1 ng-bind="post.title"></h1>
      <div ng-bind-html="post.text_html"></div>
    </div>
  </script>

  <script type="text/ng-template" id="categorygroup.html">
    <div class="categorygroup-view category-list-view">
      categorygroup view
    </div>
  </script>

  <script type="text/ng-template" id="addpostitem.html">
      <form name="addpostForm" class="add-post-view">
        <!-- <ol class="todolist">
          <li class="active">{{tr('Llenar')}}</li>
          <li>{{tr('Confirmar')}}</li>
          <li>{{tr('¡Ya está!')}}</li>
        </ol> -->
        <div class="formfields">
          <p>
            <span style="color:#B0B0B0;font-size:small;display:block" ng-bind="tr('Ciudad:')"></span>
            <span style="display:block" ng-bind="geoloc.crc"></span>
          </p>
          <p>
            <span style="color:#B0B0B0;font-size:small;display:block" ng-bind="tr('Categoría:')"></span>
            <span style="display:block" ng-bind="category.title"></span>
          </p>
          <div class="piclist">
            <div class="pic" ng-repeat="pic in addpost.pics track by $index">
              <input id="inputImage{{$index}}" type="file" accept="image/*" image="addpost.pics[$index]" resize-max-height="500" resize-max-width="500" resize-quality="0.7">
              <div ng-if="addpost.pics[$index].wait && !addpost.pics[$index].resized" class="wait"><md-progress-circular md-mode="indeterminate" class="md-hue-3"></md-progress-circular></div>
              <img ng-if="addpost.pics[$index].resized" ng-src="{{addpost.pics[$index].resized.dataURL}}">
              <md-button ng-if="addpost.pics[$index].resized" class="remove-btn md-fab md-mini" aria-label="Remove"><md-icon md-svg-src="static/icons/trash-a.svg" ng-click="addpost.pics[$index].removeImage()"></md-icon></md-button>
            </div>
          </div>
          <md-input-container>
            <label>Email:</label>
            <input type="text" name="addpostEmail" ng-model="addpost.email" /*required*/ md-maxlength="100" /*md-minlength="6"*/ >
            <div ng-messages="addpostForm.addpostEmail.$error" ng-show="addpostForm.addpostEmail.$dirty">
              <div ng-message="required">This is required!</div>
              <div ng-message="md-maxlength">That is too long!</div>
              <div ng-message="minlength">That is too short!</div>
            </div>
          </md-input-container>
          <md-input-container>
            <label>Título:</label>
            <input type="text" name="addpostTitle" ng-model="addpost.title" /*required*/ md-maxlength="100" /*md-minlength="10"*/ >
            <div ng-messages="addpostForm.addpostTitle.$error" ng-show="addpostForm.addpostTitle.$dirty">
              <div ng-message="required">This is required!</div>
              <div ng-message="md-maxlength">That is too long!</div>
              <div ng-message="minlength">That is too short!</div>
            </div>
          </md-input-container>
          <md-input-container>
            <label>Texto:</label>
            <textarea name="addpostText" ng-model="addpost.text" md-maxlength="10000"></textarea></p>
            <div ng-messages="addpostForm.addpostText.$error" ng-show="addpostForm.addpostText.$dirty">
              <div ng-message="required">This is required!</div>
              <div ng-message="md-maxlength">That is too long!</div>
              <div ng-message="minlength">That is too short!</div>
            </div>
          </md-input-container>
          <md-input-container>
            <md-select placeholder="Válido por:" ng-model="addpost.expiresDelta" aria-label="Select valid for">
              <md-option ng-value="opt[0]" ng-repeat="opt in expiresDeltaOptions">{{opt[1]}}</md-option>
            </md-select>
          </md-input-container>
          <div class="md-actions" layout="row">
            <span flex></span>
            <md-button ng-click="addpostSubmit()" class="md-raised md-primary">
              Publicar
            </md-button>
          </div>
        </div>
      </form>
  </script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-route.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.10.0/angular-material.js"></script>
  <script src="static/libs/angularjs-imageupload-directive/public/javascripts/imageupload.js"></script>
  <script src="static/src/utils.js"></script>
  <script src="static/src/app.js"></script>
  <script src="static/src/services.js"></script>
  <script src="static/src/controllers.js"></script>
  <script src="static/src/directives.js"></script>
</html>